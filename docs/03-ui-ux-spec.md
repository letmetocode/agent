# Frontend 控制台 IA 与 UI/UX 规范（2026-02）

## 1. 文档目标

统一前端页面的“信息结构 + 交互逻辑 + 视觉基线 + 工程落地方式”，确保控制台围绕 Agent 主路径高效可用。

设计原则：

- 极简：减少视觉噪音，保留必要信息。
- 现代：强调布局秩序、组件一致性、状态清晰。
- 克制：低频功能后置，避免主路径干扰。
- 高可读：优先信息层级与扫描效率。

## 2. 信息架构（IA）

### 2.1 一级导航（工作域）

1. 工作台（`/workspace`）
2. 对话与执行（`/sessions`、`/sessions/:sessionId`）
3. 任务中心（`/tasks`、`/tasks/:taskId`）
4. 资产中心（`/assets/tools`、`/assets/knowledge`、`/assets/knowledge/:kbId`）
5. 观测与日志（`/observability/overview`、`/observability/logs`）
6. 设置（`/settings/profile`）

补充治理入口：

- Workflow Draft（`/workflows/drafts`）
- 分享结果页（`/share/tasks/:taskId`）

### 2.2 导航层级规则

- 一级导航承载工作域，不承载实体细节。
- 对话历史折叠在“对话与执行”内部侧栏，不单独做一级页面。
- 主操作统一为“新聊天”，直接进入对话输入。

## 3. 关键页面布局（文字线框）

### 3.1 工作台 `/workspace`

布局（12 栅格）：

- 顶部（12）：标题 + 主动作“新聊天” + 次动作“查看任务中心”
- 第一行（8+4）：快捷启动卡 + 系统健康卡
- 第二行（6+6）：最近会话 + 运行中任务
- 第三行（12）：最近产出与可复用结果

### 3.2 对话与执行 `/sessions`、`/sessions/:sessionId`

布局（2.5 栏）：

- 左栏（280）：`新聊天`按钮 + 历史会话列表
- 中栏（自适应）：消息主阅读区 + 底部输入条（ChatGPT 风格）
- 右栏（360）：执行状态时间线（流式）

关键交互：

- 未选会话时显示空态引导（示例输入）。
- 发送消息只触发一个入口：`POST /api/v3/chat/messages`。
- 中间态在右栏展示，不污染主聊天最终消息。
- `answer.final` 到达后刷新历史，主区仅保留最终结果。
- 流断开时先自动重连（指数退避、最多 3 次），失败后切换历史轮询兜底（1.5s/次，30s 超时）。
- 断链恢复提示降噪：先静默同步历史，确认仍在执行才提示“重连中”；同类错误提示 10 秒内去重。

### 3.3 任务中心 `/tasks`

- 顶部筛选：关键词、状态、分页控制、视图切换
- 主区默认列表（服务端分页）
- 看板作为补充视图

### 3.4 任务详情 `/tasks/:taskId`

- 顶部动作条：暂停 / 继续 / 取消 / 从失败节点重试
- 主区：执行时间轴 + 结果与引用 + 执行记录
- 侧栏：任务元信息 + 分享链接管理 + 导出

### 3.5 资产与治理页

- 工具页：表格主视图 + 状态标识 + 详情抽屉
- 知识库页：列表 + 文档明细 + 检索测试
- Workflow Draft：筛选列表 + 草案详情 + 发布动作

## 4. 核心用户路径（必须打通）

### 4.1 新聊天（默认）

- 入口：顶栏“新聊天”按钮（全局）
- 操作：输入目标 -> 发送
- 系统：自动选择默认 Agent（assistant 优先）
- 结果：创建/复用会话并进入执行态

### 4.2 执行与中途可见

- 流式事件：`message.accepted`、`planning.started`、`task.progress`、`task.completed`
- 侧栏时间线实时更新
- 聊天主区不展示中间过程文本为最终结论

### 4.3 结果与沉淀

- 终态事件：`answer.finalizing` -> `answer.final`
- 最终答案以 `answer.final` 为准
- 历史会话可在左栏快速回溯

### 4.4 导出与分享

- 在任务详情执行导出与分享
- 不将分享能力置于主聊天主路径，避免分散认知

## 5. 组件与状态规范

### 5.1 页面基线组件

- 页面容器：`page-container`
- 页头：`PageHeader`
- 状态标签：`StatusTag` / `Tag`
- 执行进度：`Timeline`

### 5.2 状态体系

- 空状态：无会话、无消息、无进度时给出下一步引导
- 加载态：区分“历史加载中”“发送中”“流连接中”
- 错误态：展示简明错误 + 可重试动作
- 连接恢复态：`retrying` 显示“重连中”，`polling` 显示“自动同步中”
- 长任务进度：右栏时间线按事件流持续追加
- 流式输出：中间态可见，最终态收敛

### 5.3 交互约束

- 主按钮每页只保留 1 个。
- 危险操作必须二次确认。
- 高级能力折叠或后置，不打断聊天主路径。

## 6. 视觉规范（Design Tokens）

### 6.1 字体与字号

- 字体：`Inter` + `Noto Sans SC` + 系统 sans-serif
- 字号阶梯：`12 / 14 / 16 / 20 / 24`
- 行高：正文 `1.6`，标题 `1.4`

### 6.2 间距、圆角、阴影

- 间距：`4 / 8 / 12 / 16 / 24 / 32`
- 圆角：输入/按钮 `8`，卡片 `12`
- 阴影：卡片 L1，浮层 L2，模态 L3

### 6.3 颜色与对比

- 主色：蓝系（强调主操作）
- 语义色：成功绿、警告橙、错误红
- 对比度：正文与背景满足 AA（建议 4.5:1）

## 7. 可实现建议（工程落地）

- 组件库：`Ant Design`
- 状态管理：`zustand`
- 布局：`Layout + Card + CSS Grid`
- 数据协议：前端主链路统一走 V3（聊天聚合 + 语义流）
- 响应式：Desktop First，`<1024` 时收起左右栏保留主聊天区

## 8. 当前落地现状

### 8.1 已完成

- `/sessions` 已切换为 ChatGPT 风格入口与会话页一体化布局。
- 新消息统一走 V3 聚合接口，不再由前端拼装旧链路。
- 历史会话折叠进左侧栏；执行状态流放在右侧栏。
- 中间态与最终态语义分离：最终只认 `answer.final`。
- 会话页已修复“需手动刷新才更新”：断链自动重连，重连失败自动历史同步，终态可自动收敛。

### 8.2 未完成 / 计划优化

- `P1`：移动端会话页进一步优化（输入区与历史切换体验）。
- `P1`：执行进度可视化增强（节点分组与过滤）。
- `P2`：键盘可达性与快捷键体系完善。

## 9. 验收清单（UI/UX）

- 用户可在 1 次点击进入“新聊天”。
- 用户可在同页完成：输入 -> 执行观察 -> 终态查看。
- 中间态不会覆盖或污染最终回复内容。
- 对话、任务、观测三条主路径视觉与交互保持一致。
